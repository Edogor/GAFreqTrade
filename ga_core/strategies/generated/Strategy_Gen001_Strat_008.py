# pragma pylint: disable=missing-docstring, invalid-name, pointless-string-statement
# flake8: noqa: F401
# isort: skip_file
# AUTO-GENERATED STRATEGY - DO NOT EDIT MANUALLY
# Generated: 2026-02-12T22:32:18.198623
# Generation: 1
# Strategy ID: Gen001_Strat_008

import numpy as np
import pandas as pd
from datetime import datetime, timedelta, timezone
from pandas import DataFrame
from typing import Dict, Optional, Union, Tuple
from functools import reduce

from freqtrade.strategy import (
    IStrategy,
    Trade,
    Order,
    PairLocks,
    informative,
    BooleanParameter,
    CategoricalParameter,
    DecimalParameter,
    IntParameter,
    RealParameter,
    timeframe_to_minutes,
    timeframe_to_next_date,
    timeframe_to_prev_date,
    merge_informative_pair,
    stoploss_from_absolute,
    stoploss_from_open,
    AnnotationType,
)

import talib.abstract as ta
from technical import qtpylib


class Strategy_Gen001_Strat_008(IStrategy):
    """
    Auto-generated strategy using 6 indicators
    
    AUTO-GENERATED by GAFreqTrade
    Generation: 1
    Parent Strategies: None (Random)
    """
    
    INTERFACE_VERSION = 3
    
    # Basic Settings
    timeframe = "30m"
    can_short: bool = False
    
    # ROI table
    minimal_roi = {'4': 0.187, '22': 0.086, '55': 0.035, '70': 0.02}
    
    # Stoploss
    stoploss = -0.066
    
    # Trailing stoploss
    trailing_stop = True
    trailing_stop_positive = 0.017
    trailing_stop_positive_offset = 0.011
    trailing_only_offset_is_reached = True
    
    # Run "populate_indicators()" only for new candle
    process_only_new_candles = True
    
    # Exit signal
    use_exit_signal = True
    exit_profit_only = False
    ignore_roi_if_entry_signal = False
    
    # Number of candles the strategy requires before producing valid signals
    startup_candle_count: int = 61
    
    # Strategy parameters
    bb_buy_threshold = DecimalParameter(0.07, 0.47, default=0.27, decimals=2, space='buy')
    adx_threshold = IntParameter(0, 40, default=20, space='buy')
    mfi_sell_threshold = IntParameter(48, 88, default=68, space='buy')
    
    # Order types
    order_types = {
        "entry": "limit",
        "exit": "limit",
        "stoploss": "market",
        "stoploss_on_exchange": False
    }
    
    order_time_in_force = {
        "entry": "GTC",
        "exit": "GTC"
    }
    
    def informative_pairs(self):
        return []
    
    def populate_indicators(self, dataframe: DataFrame, metadata: dict) -> DataFrame:
        """
        Adds TA indicators to the given DataFrame
        """
        # SMA
        dataframe["sma_61"] = ta.SMA(dataframe, timeperiod=61)

        # Bollinger Bands
        bollinger = qtpylib.bollinger_bands(qtpylib.typical_price(dataframe), window=15, stds=1.54)
        dataframe["bb_lowerband"] = bollinger["lower"]
        dataframe["bb_middleband"] = bollinger["mid"]
        dataframe["bb_upperband"] = bollinger["upper"]
        dataframe["bb_percent"] = (dataframe["close"] - dataframe["bb_lowerband"]) / (dataframe["bb_upperband"] - dataframe["bb_lowerband"])
        dataframe["bb_width"] = (dataframe["bb_upperband"] - dataframe["bb_lowerband"]) / dataframe["bb_middleband"]

        # ADX
        dataframe["adx"] = ta.ADX(dataframe, timeperiod=19)

        # MFI
        dataframe["mfi"] = ta.MFI(dataframe, timeperiod=14)

        # Stochastic
        stoch = ta.STOCH(dataframe, fastk_period=7, slowk_period=3, slowd_period=4)
        dataframe["slowk"] = stoch["slowk"]
        dataframe["slowd"] = stoch["slowd"]

        # ATR
        dataframe["atr"] = ta.ATR(dataframe, timeperiod=12)

        
        return dataframe
    
    def populate_entry_trend(self, dataframe: DataFrame, metadata: dict) -> DataFrame:
        """
        Based on TA indicators, populates the entry signal for the given dataframe
        """
        conditions = []
        
        conditions.append(dataframe["bb_percent"] < self.bb_buy_threshold.value)
        conditions.append(dataframe["adx"] > self.adx_threshold.value)
        conditions.append((qtpylib.crossed_above(dataframe["slowk"], dataframe["slowd"])))
        conditions.append(dataframe["close"] < dataframe["bb_lowerband"])
        
        if conditions:
            dataframe.loc[
                reduce(lambda x, y: x & y, conditions),
                'enter_long'
            ] = 1
        
        return dataframe
    
    def populate_exit_trend(self, dataframe: DataFrame, metadata: dict) -> DataFrame:
        """
        Based on TA indicators, populates the exit signal for the given dataframe
        """
        conditions = []
        
        conditions.append(dataframe["mfi"] > self.mfi_sell_threshold.value)
        conditions.append((qtpylib.crossed_below(dataframe["slowk"], dataframe["slowd"])))
        conditions.append(dataframe["adx"] < self.adx_threshold.value)
        
        if conditions:
            dataframe.loc[
                reduce(lambda x, y: x & y, conditions),
                'exit_long'
            ] = 1
        
        return dataframe
